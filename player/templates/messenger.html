{% load helpers %}

{% template 'chat' %}
<div class="chat <% active %> <%#if uid %>player-<% uid %><%/if%>" id="chat-<% chatid %>" data-chatid="<% chatid %>">
    <div class="messages">

    </div>

    <div class="msg-row msg-form">
        <div class="name">
            <span class="user-name">
                {{ user.name }}
            </span>
            <span class="char-name">
                {% if is_dm %}
                    DM
                {% elif char %}
                    {{ char.name }}
                {% endif %}
            </span>
        </div>
        <input data-id="<% chatid %>" class="msg-input" type="text" name="msg" placeholder="Say..." autocomplete="off">
    </div>
</div>
{% endtemplate %}

{% template 'chat-btn' %}
    <button class="<%#if uid %>player-<% uid %> player-btn<%/if%> chat-btn btn btn-mini <% classes %>" data-chatid="<% chatid %>">
        <div class="active-indicate"></div>
        <i class="icon-comments-alt has-msgs player-atext"></i>
    </button>
{% endtemplate %}

{% json '{"chatid": "campaign", "classes": "active btn-info", "name": "Campaign", "active": "active"}' as context %}


<div class="chat-group">
    <div class="chat-sidebar chat-btns">
        {% render_template 'chat-btn' context %}
    </div>
    {% render_template 'chat' context %}
</div>

<!-- Player Color Customizations, div is here to wrap them up -->
<div id="player-colors">
    {% template 'player_colors_wrapper' %}
    <style id="player-<% uid %>-colors">
        <% css %>
    </style>
    {% endtemplate %}

    {% template 'player_colors' %}
        .player-<% uid %> {
            @color: #<% color %>;
            @contrast: contrast(@color, darken(@color, 20%), lighten(@color, 20%));
            @contrast-more: contrast(@color, darken(@color, 30%), lighten(@color, 30%));
            @contrast-text: contrast(@color, #EEE, #222);

            &.active.player-acolor,
            & .active.player-acolor,
            &.player-color,
            & .player-color {
                color: @color;
            }
            &.active.player-atext,
            & .active.player-atext,
            &.player-text,
            & .player-text {
                color: @contrast-text;
            }
            &.active.player-abg,
            & .active.player-abg,
            &.player-bg,
            & .player-bg {
                background-color: @color;
            }
            &.active.player-bg-grad,
            & .active.player-bg-grad,
            &.player-bg-grad,
            & .player-bg-grad {
                background-image: -webkit-linear-gradient(top, @color, @contrast);
                background-image: -moz-linear-gradient(top, @color, @contrast);
                background-image: -o-linear-gradient(top, @color, @contrast);
                background-image: -ms-linear-gradient(top, @color, @contrast);
                background-image: linear-gradient(top, @color, @contrast);
            }

            &.player-btn,
            & .player-btn {
                background-image: -webkit-linear-gradient(top, @color, @contrast);
                background-image: -moz-linear-gradient(top, @color, @contrast);
                background-image: -o-linear-gradient(top, @color, @contrast);
                background-image: -ms-linear-gradient(top, @color, @contrast);
                background-image: linear-gradient(top, @color, @contrast);
                background-color: @color;
            }
            &.player-btn:hover,
            & .player-btn:hover {
                background-image: -webkit-linear-gradient(top, @color, @contrast);
                background-image: -moz-linear-gradient(top, @color, @contrast);
                background-image: -o-linear-gradient(top, @color, @contrast);
                background-image: -ms-linear-gradient(top, @color, @contrast);
                background-image: linear-gradient(top, @color, @contrast);
                background-color: @contrast;
            }
            &.player-btn:active,
            & .player-btn:active,
            &.player-btn.active,
            & .player-btn.active {
                background-image: -webkit-linear-gradient(top, @contrast-more, @contrast);
                background-image: -moz-linear-gradient(top, @contrast-more, @contrast);
                background-image: -o-linear-gradient(top, @contrast-more, @contrast);
                background-image: -ms-linear-gradient(top, @contrast-more, @contrast);
                background-image: linear-gradient(top, @contrast-more, @contrast);
                background-color: @contrast;
            }
        }
    {% endtemplate %}
</div>
<!-- End Player Colors -->



{% template 'message' %}
    <div class="row-fluid msg-row <% type %> <%#if uid %>player-<% uid %><%/if%>">
        <span class="prefix">
            <span class="name player-color"><% name %></span>:
        </span>
        <span class="msg player-color"><% msg %><br/></span>
    </div>
{% endtemplate %}




